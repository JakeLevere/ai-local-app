<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Weekly Calendar</title>
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      display: flex;
      height: 100vh;
    }

    .sidebar {
      width: 250px;
      padding: 10px;
      background: #f4f4f4;
      border-right: 1px solid #ccc;
    }

    .task-list {
      margin-bottom: 20px;
    }

    .draggable {
      background: #d0e0ff;
      padding: 5px;
      margin: 5px 0;
      cursor: grab;
      border: 1px solid #999;
    }

    .calendar-container {
      flex: 1;
      overflow-x: auto;
      position: relative;
    }

    .calendar {
      display: grid;
      grid-template-columns: 60px repeat(7, 1fr);
      grid-auto-rows: 40px;
      border-collapse: collapse;
      position: relative;
      min-width: 900px;
    }

    .calendar .time, .calendar .day {
      background: #eee;
      text-align: center;
      font-weight: bold;
      border-bottom: 1px solid #ccc;
    }

    .calendar .cell {
      border: 1px solid #ddd;
      position: relative;
    }

    .event {
      position: absolute;
      background: #88d;
      color: #fff;
      padding: 2px 4px;
      border-radius: 4px;
      font-size: 12px;
      z-index: 10;
    }

    .current-time-line {
      position: absolute;
      left: 0;
      right: 0;
      height: 2px;
      background: red;
      z-index: 5;
    }

    .header {
      display: contents;
    }
  </style>
</head>
<body>

  <div class="sidebar">
    <h3>Tasks</h3>
    <select class="task-list">
      <option>Work</option>
      <option>Exercise</option>
      <option>Study</option>
    </select>

    <div class="draggable" draggable="true">Workout</div>
    <div class="draggable" draggable="true">Meeting</div>
    <div class="draggable" draggable="true">Focus</div>

    <hr>
    <div style="text-align:center;">
      <img src="../images/Memo.png" alt="Memo" style="width:50px;height:50px;border-radius:50%;">
      <p>10AM</p>
      <p>Current Time</p>
    </div>
  </div>

  <div class="calendar-container" id="calendar-container">
    <div class="calendar" id="calendar">
      <div class="header"></div>
    </div>
    <div class="current-time-line" id="time-line"></div>
  </div>

  <script>
    const calendar = document.getElementById('calendar');
    const header = document.querySelector('.header');

    const days = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
    const hours = Array.from({ length: 16 }, (_, i) => i + 7); // 7AM - 10PM

    // First row - time label + days
    header.innerHTML = `<div class="time"></div>` + days.map(day => `<div class="day">${day}</div>`).join('');

    // Fill time column and calendar cells
    hours.forEach(hour => {
      // Time label
      const timeCell = document.createElement('div');
      timeCell.className = 'time';
      timeCell.textContent = `${hour}:00`;
      calendar.appendChild(timeCell);

      // Calendar cells for each day
      for (let d = 0; d < 7; d++) {
        const cell = document.createElement('div');
        cell.className = 'cell';
        cell.dataset.day = d;
        cell.dataset.hour = hour;
        cell.ondragover = e => e.preventDefault();
        cell.ondrop = e => {
          const text = e.dataTransfer.getData('text');
          const event = document.createElement('div');
          event.className = 'event';
          event.textContent = text;
          event.style.top = '0';
          event.style.left = '0';
          cell.appendChild(event);
        };
        calendar.appendChild(cell);
      }
    });

    // Drag handlers
    document.querySelectorAll('.draggable').forEach(elem => {
      elem.ondragstart = e => {
        e.dataTransfer.setData('text', e.target.textContent);
      };
    });

    // Current time indicator
    function updateTimeLine() {
      const now = new Date();
      const hour = now.getHours();
      const minutes = now.getMinutes();
      const offset = ((hour - 7) + minutes / 60) * 40; // 40px per hour
      const line = document.getElementById('time-line');
      line.style.top = `${offset}px`;
    }

    updateTimeLine();
    setInterval(updateTimeLine, 60000); // update every minute
  </script>

</body>
</html>
