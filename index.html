<!DOCTYPE html>
<!-- Default persona: Memo -->
<html>
<head>
    <title>Personal AI Dashboard</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' 'unsafe-inline' https://player.twitch.tv https://static.twitchcdn.net https://cdn.tailwindcss.com https://cdn.jsdelivr.net;
        style-src 'self' 'unsafe-inline' https://player.twitch.tv https://static.twitchcdn.net;
        img-src 'self' file: data: blob: https:;
        frame-src 'self' file: https://player.twitch.tv https: http:;
        connect-src 'self' https://*.twitch.tv wss://*.twitch.tv https:;
        media-src 'self' blob: https:;
        font-src 'self' https://static.twitchcdn.net;
    ">
    <link rel="stylesheet" href="style.css">
</head>
<body class="pre-login">
    <div id="title-bar">
        <div id="window-controls">
            <button id="min-button" class="window-button" aria-label="Minimize">&#x2212;</button>
            <button id="max-button" class="window-button" aria-label="Maximize">&#x25a1;</button>
            <button id="close-button" class="window-button" aria-label="Close">&#x2715;</button>
        </div>
    </div>
    <div id="login-overlay">
        <form id="login-form">
            <h1 id="login-title">Your Personal Ai Vault</h1>
            <input type="password" id="login-pass" placeholder="Password">
            <button type="submit">Login</button>
        </form>
    </div>
    <div class="app-container">
        <aside id="left-sidebar">
            <svg id="collapse-arrow" viewBox="0 0 24 24">
                <path d="M15 18L9 12L15 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <h1 id="app-title">Your Personal Ai Vault</h1>
            <div id="persona-section">
                <h2>AI Personas</h2>
                <!-- Persona list container inserted for persona selection UI -->
                <div id="persona-list-container"></div>
            <div id="info-panels">
                <div id="config-header">Configuration</div>
                <div id="config-content">
                    <div class="dropdown"> <div class="dropdown-header" id="pre-prompt-header">Pre Prompt</div> <div class="dropdown-content" id="pre-prompt-content"> <textarea id="pre-prompt-text"></textarea> <div class="dropdown-buttons"> <button id="save-pre-prompt">Save</button> <button id="auto-pre-prompt" style="display:none;">Auto-Populate</button> </div> </div> </div>
                    <div class="dropdown config-sub-only"> <div class="dropdown-header" id="memory-prompt-header">Memory Prompt</div> <div class="dropdown-content" id="memory-prompt-content"> <textarea id="memory-prompt-text"></textarea> <div class="dropdown-buttons"> <button id="save-memory-prompt">Save</button> </div> </div> </div>
                    <div class="dropdown config-sub-only"> <div class="dropdown-header" id="memory-header">Memory</div> <div class="dropdown-content" id="memory-content"> <textarea id="memory-text"></textarea> <div class="dropdown-buttons"> <button id="save-memory">Save</button> <button id="update-memory">Update</button> </div> </div> </div>
                    <div class="dropdown"> <div class="dropdown-header" id="conversations-header">Stored Conversations</div> <div class="dropdown-content" id="conversations-content"> <textarea id="conversations-text" readonly></textarea> <div class="dropdown-buttons"> </div> </div> </div>
                    <div class="dropdown"> 
                        <div class="dropdown-header" id="profile-header">Identity Profile</div> 
                        <div class="dropdown-content" id="profile-content"> 
                            <div class="profile-field">
                                <label for="profile-name">Name:</label>
                                <input type="text" id="profile-name" placeholder="Persona name">
                            </div>
                            <div class="profile-field">
                                <label for="profile-description">Description:</label>
                                <textarea id="profile-description" placeholder="Describe this persona's role and personality"></textarea>
                            </div>
                            <div class="profile-field">
                                <label for="profile-style">Style:</label>
                                <select id="profile-style">
                                    <option value="conversational">Conversational</option>
                                    <option value="professional">Professional</option>
                                    <option value="casual">Casual</option>
                                    <option value="formal">Formal</option>
                                    <option value="technical">Technical</option>
                                    <option value="creative">Creative</option>
                                </select>
                            </div>
                            <div class="profile-field">
                                <label for="profile-pronouns">Pronouns:</label>
                                <input type="text" id="profile-pronouns" placeholder="e.g., they/them">
                            </div>
                            <div class="profile-field">
                                <label for="profile-topics">Topics of Interest:</label>
                                <input type="text" id="profile-topics" placeholder="Comma-separated topics">
                            </div>
                            <div class="dropdown-buttons"> 
                                <button id="save-profile">Save Profile</button> 
                            </div> 
                        </div> 
                    </div>
                    <div class="dropdown"> 
                        <div class="dropdown-header" id="memory-tiers-header">Memory System</div> 
                        <div class="dropdown-content" id="memory-tiers-content"> 
                            <div class="memory-tier">
                                <h4>Short-term History</h4>
                                <div class="memory-stats">
                                    <span>Messages: <span id="short-term-count">0</span>/10</span>
                                    <button id="clear-short-term" class="small-button">Clear</button>
                                </div>
                                <div id="short-term-list" class="memory-list"></div>
                            </div>
                            <div class="memory-tier">
                                <h4>Mid-term Memory</h4>
                                <div class="memory-stats">
                                    <span>Slots: <span id="mid-term-count">0</span>/20</span>
                                    <button id="prune-mid-term" class="small-button">Prune Old</button>
                                </div>
                                <div id="mid-term-list" class="memory-list"></div>
                            </div>
                            <div class="memory-tier">
                                <h4>Long-term Store</h4>
                                <div class="memory-stats">
                                    <span>Items: <span id="long-term-count">0</span></span>
                                    <button id="view-long-term" class="small-button">View Details</button>
                                </div>
                                <div id="long-term-list" class="memory-list" style="display:none;"></div>
                            </div>
                            <div class="dropdown-buttons"> 
                                <button id="run-maintenance">Run Maintenance</button> 
                                <button id="export-memory">Export Memory</button>
                            </div> 
                        </div> 
                    </div>
                </div>
            </div>
            </div>
            <!-- Program Maker moved to left sidebar -->
            <div id="program-maker-section">
                <h2>Program Maker</h2>
                <textarea id="program-description" placeholder="Describe your program..."></textarea>
                <button id="generate-program">Generate</button>
                <div id="program-output"></div>
            </div>
        </aside>

        <main id="main-content">
             <div id="central-display">
                 <div id="persona-status-bar" class="collapsed">
                     <div id="status-header">
                         <img id="persona-image" src="./images/placeholder.png" alt="Current AI Persona">
                         <div id="status-text-content">
                             <div id="status-title">No Persona Selected</div>
                             <div id="status-info">
                                 <span id="conv-count">Conversations: 0</span>
                                 <span id="last-interaction">Last Interaction: N/A</span>
                             </div>
                         </div>
                     </div>
                    <!-- Status collapse arrow removed - panel stays collapsed -->
                    <div id="deck-container">
                        <div id="deck-main" class="deck-icon">1</div>
                        <div id="deck-icons" class="deck-icons"></div>
                    </div>
                    <ul id="slide-tabs" class="slide-tabs">
                        <li class="slide-tab" data-display-id="display1"><img src="./images/placeholder.png" alt="Slide 1" class="slide-icon"><span class="slide-name">1</span></li>
                        <li class="slide-tab" data-display-id="display2"><img src="./images/placeholder.png" alt="Slide 2" class="slide-icon"><span class="slide-name">2</span></li>
                        <li class="slide-tab" data-display-id="display3"><img src="./images/placeholder.png" alt="Slide 3" class="slide-icon"><span class="slide-name">3</span></li>
                        <li class="slide-tab" data-display-id="display4"><img src="./images/placeholder.png" alt="Slide 4" class="slide-icon"><span class="slide-name">4</span></li>
                        <li class="slide-tab" data-display-id="display5"><img src="./images/placeholder.png" alt="Slide 5" class="slide-icon"><span class="slide-name">5</span></li>
                        <li class="slide-tab" data-display-id="display6"><img src="./images/placeholder.png" alt="Slide 6" class="slide-icon"><span class="slide-name">6</span></li>
                        <li class="slide-tab" data-display-id="display7"><img src="./images/placeholder.png" alt="Slide 7" class="slide-icon"><span class="slide-name">7</span></li>
                        <li class="slide-tab" data-display-id="display8"><img src="./images/placeholder.png" alt="Slide 8" class="slide-icon"><span class="slide-name">8</span></li>
                        <li class="slide-tab" data-display-id="display9"><img src="./images/placeholder.png" alt="Slide 9" class="slide-icon"><span class="slide-name">9</span></li>
                        <li class="slide-tab" data-display-id="display10"><img src="./images/placeholder.png" alt="Slide 10" class="slide-icon"><span class="slide-name">10</span></li>
                    </ul>
                </div>
                 <div id="displays-container">
                     <div class="display-wrapper"> <div class="display" id="display1"> <span class="display-number">1</span> <span class="clear-button" data-display-id="display1">X</span> <iframe id="iframe1"></iframe> <img id="image1" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display2"> <span class="display-number">2</span> <span class="clear-button" data-display-id="display2">X</span> <iframe id="iframe2"></iframe> <img id="image2" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display3"> <span class="display-number">3</span> <span class="clear-button" data-display-id="display3">X</span> <iframe id="iframe3"></iframe> <img id="image3" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display4"> <span class="display-number">4</span> <span class="clear-button" data-display-id="display4">X</span> <iframe id="iframe4"></iframe> <img id="image4" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display5"> <span class="display-number">5</span> <span class="clear-button" data-display-id="display5">X</span> <iframe id="iframe5"></iframe> <img id="image5" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display6"> <span class="display-number">6</span> <span class="clear-button" data-display-id="display6">X</span> <iframe id="iframe6"></iframe> <img id="image6" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display7"> <span class="display-number">7</span> <span class="clear-button" data-display-id="display7">X</span> <iframe id="iframe7"></iframe> <img id="image7" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display8"> <span class="display-number">8</span> <span class="clear-button" data-display-id="display8">X</span> <iframe id="iframe8"></iframe> <img id="image8" alt="Generated Image"> <div class="loading"></div> </div> </div>
                    <div class="display-wrapper"> <div class="display" id="display9"> <span class="display-number">9</span> <span class="clear-button" data-display-id="display9">X</span> <iframe id="iframe9"></iframe> <img id="image9" alt="Generated Image"> <div class="loading"></div> </div> </div>
                     <div class="display-wrapper"> <div class="display" id="display10"> <span class="display-number">10</span> <span class="clear-button" data-display-id="display10">X</span> <iframe id="iframe10"></iframe> <img id="image10" alt="Generated Image"> <div class="loading"></div> </div> </div>

                     <div class="scroll-spacer"></div>
                     </div>
             </div>
         </main>

        <aside id="right-chat">
              <!-- Persona video overlay -->
              <div id="persona-video-overlay">
                  <div id="persona-video-header">
                      <select id="persona-select"></select>
                      <span id="favorite-star-overlay" class="favorite-star">☆</span>
                      <svg id="video-minimize-arrow" viewBox="0 0 24 24">
                          <path d="M6 15L12 9L18 15" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                      </svg>
                  </div>
                  <div id="persona-video-container">
                      <video id="persona-preview-video" src="./videos/placeholder.mp4" autoplay loop muted playsinline poster="./images/placeholder.png"></video>
                      <img id="persona-preview-image" src="./images/placeholder.png" alt="Persona preview fallback" />
                  </div>
              </div>
              <div id="chat-log-container"> <svg id="chat-collapse-arrow" viewBox="0 0 24 24"> <path d="M9 18L15 12L9 6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/> </svg> <h2>Chat</h2> <div id="chat-log"></div> </div> <div id="chat-input-area"> <input type="text" id="user_input" placeholder="Send a message..."> <button type="button" id="send_button">Chat</button> </div>
         </aside>
    </div>

    <script src="renderer.js"></script>
    <script src="components/diagnosticsPanel.js"></script>
    <script>
        // Initialize diagnostics panel if in dev mode
        if (localStorage.getItem('devMode') === 'true') {
            diagnosticsPanel.init();
        }
        
        // Add dev mode toggle to settings (if settings exist)
        document.addEventListener('DOMContentLoaded', () => {
            // Add keyboard shortcut for dev mode toggle (Ctrl+Shift+M)
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey && e.shiftKey && e.key === 'M') {
                    const currentMode = localStorage.getItem('devMode') === 'true';
                    diagnosticsPanel.setDevMode(!currentMode);
                    console.log(`Dev mode ${!currentMode ? 'enabled' : 'disabled'}`);
                }
            });
        });
    </script>
</body>
</html>
